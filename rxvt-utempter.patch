diff -Nru rxvt-2.7.5/src/Makefile.in rxvt-2.7.5.new/src/Makefile.in
--- rxvt-2.7.5/src/Makefile.in	Wed Feb  7 21:10:53 2001
+++ rxvt-2.7.5.new/src/Makefile.in	Wed Feb  7 21:12:04 2001
@@ -19,27 +19,27 @@
 first_rule: all
 dummy:
 
-LIBSRCS = command.c graphics.c grkelot.c init.c logging.c main.c menubar.c \
+LIBSRCS = command.c graphics.c grkelot.c init.c main.c menubar.c \
 	misc.c netdisp.c screen.c scrollbar.c scrollbar-rxvt.c \
 	scrollbar-next.c scrollbar-xterm.c strings.c xdefaults.c xpm.c
 
 SRCS =  rxvt.c $(LIBSRCS)
 
 HDRS =	command.h grkelot.h init.h menubar.h protos.h rxvtgrx.h version.h \
-	feature.h logging.h netdisp.h rxvt.h screen.h
+	feature.h netdisp.h rxvt.h screen.h
 
 OBJS =	@OBJLIST@ rxvt.o
 LIBOBJS = @LIBOBJLIST@
 LIBVERSION = @LIBVERSION@
 
 EXTPROS = command.extpro graphics.extpro grkelot.extpro init.extpro \
-	logging.extpro main.extpro menubar.extpro misc.extpro netdisp.extpro \
+	main.extpro menubar.extpro misc.extpro netdisp.extpro \
 	screen.extpro scrollbar.extpro scrollbar-rxvt.extpro \
 	scrollbar-next.extpro scrollbar-xterm.extpro strings.extpro \
 	xdefaults.extpro xpm.extpro
 
 INTPROS = command.intpro graphics.intpro grkelot.intpro init.intpro \
-	logging.intpro main.intpro menubar.intpro misc.intpro netdisp.intpro \
+	main.intpro menubar.intpro misc.intpro netdisp.intpro \
 	screen.intpro scrollbar.intpro scrollbar-rxvt.intpro \
 	scrollbar-next.intpro scrollbar-xterm.intpro strings.intpro \
 	xdefaults.intpro xpm.intpro
@@ -80,7 +80,7 @@
 all: allbin
 
 rxvt: version.h rxvt.o librxvt.la
-	$(LIBTOOL) --mode=link $(LINK) rxvt.o librxvt.la $(LIBS) $(XLIB) $(DLIB) -o $@
+	$(LIBTOOL) --mode=link $(LINK) rxvt.o librxvt.la $(LIBS) $(XLIB) $(DLIB) -lutempter -lutil -o $@
 
 protos:
 	@for I in $(EXTPROS); do \
@@ -133,7 +133,6 @@
 graphics.o:         graphics.c  $(DEPS) graphics.intpro
 grkelot.o:          grkelot.c   $(DEPS) grkelot.intpro	grkelot.h
 init.o:             init.c      $(DEPS) init.intpro	init.h	
-logging.o:          logging.c   $(DEPS) logging.intpro	logging.h
 main.o:             main.c      $(DEPS) main.intpro
 menubar.o:          menubar.c   $(DEPS) menubar.intpro	menubar.h version.h
 misc.o:             misc.c      $(DEPS) misc.intpro
@@ -152,7 +151,6 @@
 graphics.lo:        graphics.c  $(DEPS) graphics.intpro	
 grkelot.lo:         grkelot.c   $(DEPS) grkelot.intpro	grkelot.h
 init.lo:            init.c      $(DEPS) init.intpro	init.h	
-logging.lo:         logging.c   $(DEPS) logging.intpro	logging.h
 main.lo:            main.c      $(DEPS) main.intpro
 menubar.lo:         menubar.c   $(DEPS) menubar.intpro	menubar.h version.h
 misc.lo:            misc.c      $(DEPS) misc.intpro
diff -Nru rxvt-2.7.5/src/main.c rxvt-2.7.5.new/src/main.c
--- rxvt-2.7.5/src/main.c	Wed Feb  7 21:10:53 2001
+++ rxvt-2.7.5.new/src/main.c	Wed Feb  7 21:10:22 2001
@@ -254,15 +254,13 @@
     if (r->h->ttydev == NULL || *r->h->ttydev == '\0')
 	return;
     if (!(r->Options & Opt_utmpInhibit)) {
-	rxvt_privileges(r, RESTORE);
 	if (action == SAVE) {
 	    r->h->next_utmp_action = RESTORE;
-	    rxvt_makeutent(r, r->h->ttydev, r->h->rs[Rs_display_name]);
+	    addToUtmp(r->h->ttydev, r->h->rs[Rs_display_name], r->cmd_fd);
 	} else if (action == RESTORE) {
 	    r->h->next_utmp_action = IGNORE;
-	    rxvt_cleanutent(r);
+	    removeFromUtmp();
 	}
-	rxvt_privileges(r, IGNORE);
     }
 }
 #endif
